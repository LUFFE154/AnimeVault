<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="shortcut icon" href="icon/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href="CSS/general.css">
    <link rel="stylesheet" href="CSS/tournament.css">

    <title>Preparativos Torneio | AnimeVault</title>
</head>
<body>
    <main>
        <div class="title flex-column">
            <span class="title-icon" >
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 18.75h-9m9 0a3 3 0 0 1 3 3h-15a3 3 0 0 1 3-3m9 0v-3.375c0-.621-.503-1.125-1.125-1.125h-.871M7.5 18.75v-3.375c0-.621.504-1.125 1.125-1.125h.872m5.007 0H9.497m5.007 0a7.454 7.454 0 0 1-.982-3.172M9.497 14.25a7.454 7.454 0 0 0 .981-3.172M5.25 4.236c-.982.143-1.954.317-2.916.52A6.003 6.003 0 0 0 7.73 9.728M5.25 4.236V4.5c0 2.108.966 3.99 2.48 5.228M5.25 4.236V2.721C7.456 2.41 9.71 2.25 12 2.25c2.291 0 4.545.16 6.75.47v1.516M7.73 9.728a6.726 6.726 0 0 0 2.748 1.35m8.272-6.842V4.5c0 2.108-.966 3.99-2.48 5.228m2.48-5.492a46.32 46.32 0 0 1 2.916.52 6.003 6.003 0 0 1-5.395 4.972m0 0a6.726 6.726 0 0 1-2.749 1.35m0 0a6.772 6.772 0 0 1-3.044 0" />
                </svg>
            </span>
            <h1>Modo Torneio <small style="font-size: 0.5em">(BETA)</small></h1>
            <p>
                Torneio no formato mata-mata com 16 ou 32 animes para coroar o vencedor. <br>
                Ao retornar para a página inicial o torneio atual será encerrado.
            </p>
        </div>
        <div class="content flex-column">
            <nav class="align-center">
                <a href="index.html" class="align-center">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
                    </svg>
                    Página Inicial
                </a>
                <div class="align-center toggle-icons">
                    <span class="change-language">
                        <span class="align-center">
                            <svg class="size-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="m10.5 21 5.25-11.25L21 21m-9-3h7.5M3 5.621a48.474 48.474 0 0 1 6-.371m0 0c1.12 0 2.233.038 3.334.114M9 5.25V3m3.334 2.364C11.176 10.658 7.69 15.08 3 17.502m9.334-12.138c.896.061 1.785.147 2.666.257m-4.589 8.495a18.023 18.023 0 0 1-3.827-5.802" />
                            </svg>
                            BR
                        </span>
                    </span>
                    <span class="change-theme align-center">
                        <svg class="size-6 light-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z" />
                        </svg>
                        <svg class="size-6 dark-icon hidden-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z" />
                        </svg>
                    </span>
                </div>
            </nav>
            <div class="body flex-column">
                <span>
                    <strong>Preencha os campos abaixo para começar o torneio.</strong>
                </span>

                <div class="body-form flex-column">
                    <span class="item flex-column">
                        <label for="ititle">Título: *</label>
                        <input type="text" name="title" id="ititle" placeholder="Máximo 70 caracteres" maxlength="70" minlength="1" >
                    </span>
                    <span class="item flex-column">
                        <label for="iamount">Quantidade: </label>
                        <select name="amount" id="iamount">
                            <option value="16" selected>16 animes</option>
                            <option value="32">32 animes</option>
                        </select>
                    </span>

                    <div class="flex-column minMaxInputs">
                        <span class="item flex-column">
                            <label for="numberMinYear">Ano mínimo:</label>
                            <span class="align-center inputs">
                                <input type="number" name="minYear" id="numberMinYear" class="inputNumber minInput" min="1960" max="2025" value="2010">
                                <input type="range" name="minYear" id="rangeMinYear" class="inputRange minRange" min="1960" max="2025" value="2010">
                            </span>
                        </span>

                        <span class="item flex-column">
                            <label for="numberMaxYear">Ano máximo: </label>
                            <span class="align-center inputs">
                                <input type="number" name="maxYear" id="numberMaxYear" class="inputNumber maxInput" min="1960" max="2025" value="2025">
                                <input type="range" name="maxYear" id="rangeMaxYear" class="inputRange maxRange" min="1960" max="2025" value="2025">
                            </span>
                        </span>
                    </div>

                    <div class="flex-column minMaxInputs">
                        <span class="item flex-column">
                            <label for="numberMinScore">Nota mínima: </label>
                            <span class="align-center inputs">
                                <input type="number" name="minScore" id="numberMinScore" class="inputNumber minInput" min="1" max="10" step="0.1" value="1">
                                <input type="range" name="minScore" id="rangeMinScore" class="inputRange minRange" min="1" max="10" step="0.1" value="1">
                            </span class="align-center">
                        </span>
                        <span class="item flex-column">
                            <label for="numberMaxScore">Nota máxima:</label>
                            <span class="align-center inputs">
                                <input type="number" name="maxScore" id="numberMaxScore" class="inputNumber maxInput" min="1" max="10" step="0.1" value="10">
                                <input type="range" name="maxScore" id="rangeMaxScore" class="inputRange maxRange" min="1" max="10" step="0.1" value="10">
                            </span>
                        </span>
                    </div>

                    <button class="default-link-button submit-button">
                        <span class="link-icon-container">
                            <svg class="default-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 18.75h-9m9 0a3 3 0 0 1 3 3h-15a3 3 0 0 1 3-3m9 0v-3.375c0-.621-.503-1.125-1.125-1.125h-.871M7.5 18.75v-3.375c0-.621.504-1.125 1.125-1.125h.872m5.007 0H9.497m5.007 0a7.454 7.454 0 0 1-.982-3.172M9.497 14.25a7.454 7.454 0 0 0 .981-3.172M5.25 4.236c-.982.143-1.954.317-2.916.52A6.003 6.003 0 0 0 7.73 9.728M5.25 4.236V4.5c0 2.108.966 3.99 2.48 5.228M5.25 4.236V2.721C7.456 2.41 9.71 2.25 12 2.25c2.291 0 4.545.16 6.75.47v1.516M7.73 9.728a6.726 6.726 0 0 0 2.748 1.35m8.272-6.842V4.5c0 2.108-.966 3.99-2.48 5.228m2.48-5.492a46.32 46.32 0 0 1 2.916.52 6.003 6.003 0 0 1-5.395 4.972m0 0a6.726 6.726 0 0 1-2.749 1.35m0 0a6.772 6.772 0 0 1-3.044 0" />
                            </svg>

                            <svg class="alt-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 9V5.25A2.25 2.25 0 0 1 10.5 3h6a2.25 2.25 0 0 1 2.25 2.25v13.5A2.25 2.25 0 0 1 16.5 21h-6a2.25 2.25 0 0 1-2.25-2.25V15M12 9l3 3m0 0-3 3m3-3H2.25" />
                            </svg>
                        </span>
                        Começar Torneio
                    </button>
                </div>
            </div>
        </div>
    </main>
</body>
</html>

<script src="JS/general.js"></script>

<script>
    if(localStorage.getItem("tournamentData")){
        window.location.href ="tournamentMatch.html";
    }
    /* Controll the input values at tournament setup */
    const minMaxInputs = document.querySelectorAll(".minMaxInputs");

    minMaxInputs.forEach(item => {
        const minInput = item.querySelector(".minInput");
        const minRange = item.querySelector(".minRange");
        const maxInput = item.querySelector(".maxInput");
        const maxRange = item.querySelector(".maxRange");

        minInput.addEventListener("input", () => {
            minRange.value = minInput.value;

            if(minInput.value > maxInput.value){
                maxInput.value = minInput.value;
                maxRange.value = minInput.value;
            }
        });

        minRange.addEventListener("input", () => {
            minInput.value = minRange.value;

            if(minRange.value > maxRange.value){
                maxInput.value = minRange.value;
                maxRange.value = minRange.value;
            }
        });

        maxInput.addEventListener("input", () => {
            maxRange.value = maxInput.value;

            if(maxInput.value < minInput.value){
                minInput.value = maxInput.value;
                minRange.value = maxInput.value;
            }
        });

        maxRange.addEventListener("input", () => {
            maxInput.value = maxRange.value;

            if(maxRange.value < minRange.value){
                minInput.value = maxRange.value;
                minRange.value = maxRange.value;
            }
        });
    });


    /* Retrieve the inputs data  + redirect to tournament page */
    const submitButton = document.querySelector(".submit-button");
    submitButton.addEventListener("click", verifyData);

    function verifyData(){
        const titleInput = document.querySelector("#ititle");
        if(titleInput.value === ""){
            alert("Erro: Título do torneio não pode ser em branco");
            return;
        }

        const formattedTitle = `${titleInput.value.slice(0,1).toUpperCase()}${titleInput.value.slice(1)}`;     

        tournamentMap = {
            title:      formattedTitle,
            amount:     document.querySelector("#iamount").value,
            minYear:    document.querySelector("#numberMinYear").value,
            maxYear:    document.querySelector("#numberMaxYear").value,
            minScore:   document.querySelector("#numberMinScore").value,
            maxScore:   document.querySelector("#numberMaxScore").value,
        };

        localStorage.setItem("tournamentData", JSON.stringify(tournamentMap));
        window.location.href = "tournamentMatch.html";
    }
</script>